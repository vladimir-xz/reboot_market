<div {{ attributes.defaults(stimulus_controller('product')) }} data-action="filter:new@window->product#filter">
    <h1>Product List</h1>

    <div class="flex items-center justify-around">
        {% if not this.query is empty   %}
        <div class=""><p>Query: </p>{{    this.query  }}</div>
        {%  endif   %}
        {%  if not this.includedCategories is empty   %}
        <div class="">Categories are included</div>
        {%  endif   %}
        {%  if not this.excludedCategories is empty   %}
        <div class="">Categories are excluded</div>
        {%  endif   %}
        {% if not this.filters is empty   %}
        <div class="">Added filters</div>
        {%  endif   %}
    </div>

    {%  set paginator = this.products  %}
    <div class="flex">
        {% for product in paginator.currentPageResults %}
            <twig:Card :product="product"/>
        {% else %}
            <p>No products found.</p>
        {% endfor %}
    </div>

    {% if paginator.haveToPaginate %}

    {{ 'Current page :' ~ paginator.currentPage  }}
    {{ 'Number of pages :' ~ paginator.nbPages  }}

    <div class="flex">
        {% if paginator.hasPreviousPage %}
        <button class="" type="button" data-action="live#update" data-model="page" data-value="{{  paginator.previousPage   }}">
            {{  paginator.previousPage   }}
        </button>
        {% endif %}

        {%  for i in range(paginator.currentPage, paginator.nbPages)  %}
        <button class="" data-action="live#update" data-model="page" data-value="{{  i   }}" type="button">
            {{  i   }}
        </button>
        
        {%  endfor   %}
    </div>
    {% endif %}

</div>
